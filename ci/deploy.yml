steps:
  - task: DotNetCoreCLI@2
    displayName: 'Pack projects'
    inputs:
      command: pack
      # searchPatternPack: 'src/*/*.csproj'
      searchPatternPack: src/SourceEngine.Demo.Parser/SourceEngine.Demo.Parser.csproj
      configuration: $(configuration)
      outputDir: $(Build.ArtifactStagingDirectory)
      includesymbols: true
      nobuild: true
      ${{ if eq(variables.tagged, False) }}:
        buildProperties: suffix=-$(Build.BuildNumber)

  - task: DotNetCoreCLI@2
    displayName: 'Push packages'
    inputs:
      command: push
      searchPatternPush: '$(Build.ArtifactStagingDirectory)/*.nupkg'
      nugetFeedType: external
      externalEndPoint: NuGetServiceConnection
